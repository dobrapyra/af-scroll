{"mappings":"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","sources":["src/index.js","src/helpers.js"],"sourcesContent":["import { each, lerp, style } from './helpers';\n\n/**\n * AFScroll (Animation Frame Scroll)\n * @param {Object} options general options\n * @property {Number} smoothForce smoothing force in range 0.0 - 1.0, 0: no smooth, 1: no scroll\n * @property {Number} smoothLimit min diff between current and target value to keep smooth loop\n * @property {Element} scrollEl static scroll wrapper element\n * @property {String} className css class name of scroll wrapper element\n * @property {Array} wrapExclude css selector to exclude from wrapping\n * @property {Number} autoHeight height checkoing period in frames, 1: each frame, 0: disabled\n * @property {Function} onUpdate callback function triggered on scroll update\n * @property {Function} onComplete callback function triggered after smooth loop stopped\n */\nexport default class AFScroll {\n  constructor({\n    smoothForce = 0.8,\n    smoothLimit = 0.2,\n    scrollEl = null,\n    className = 'afScroll',\n    wrapExclude = 'script, link',\n    autoHeight = 12,\n    onUpdate = () => {},\n    onComplete = () => {}\n  } = {}) {\n    this.smoothFactor = 1 - smoothForce;\n    this.smoothLimit = smoothLimit;\n    this.staticScrollEl = scrollEl;\n    this.className = className;\n    this.wrapExclude = wrapExclude;\n    this.autoHeight = autoHeight;\n    this.onUpdate = onUpdate;\n    this.onComplete = onComplete;\n\n    this.targetScroll = 0;\n    this.lastScroll = 0;\n    this.lockedScroll = null;\n\n    this.bodyEl = document.getElementsByTagName('body')[0];\n    this.scrollEl = null;\n    this.autoHeightFrame = 0;\n    this.lastHeight = null;\n\n    this.bindThis();\n    this.init();\n  }\n\n  /**\n   * initialize AFScroll\n   * @public\n   */\n  init() {\n    if (this.scrollEl !== null) return;\n\n    this.targetScroll = window.scrollY;\n    this.createScroll();\n    this.onResize();\n\n    this.scrollTo(this.targetScroll);\n    this.updateScroll(this.targetScroll);\n\n    this.bindEvents();\n    this.startAutoHeight();\n  }\n\n  /**\n   * create scroll wrapper element\n   */\n  createScroll() {\n    const { bodyEl, staticScrollEl } = this;\n\n    const scrollEl = staticScrollEl !== null\n      ? staticScrollEl\n      : document.createElement('div');\n    style(scrollEl, {\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      width: '100%',\n      height: '100%',\n      overflow: 'hidden',\n    });\n\n    this.scrollEl = scrollEl;\n\n    if (staticScrollEl !== null) return;\n\n    const { className, wrapExclude } = this;\n\n    scrollEl.setAttribute('class', className);\n\n    const childrenArr = [];\n    each(bodyEl.children, childEl => {\n      if (childEl === scrollEl || childEl.matches(wrapExclude)) return true;\n      childrenArr.push(childEl);\n    });\n    each(childrenArr, childEl => {\n      scrollEl.appendChild(childEl);\n    });\n    bodyEl.insertBefore(scrollEl, bodyEl.children[0]);\n  }\n\n  bindThis() {\n    this.onScrollEvent = this.onScroll.bind(this);\n    this.onResizeEvent = this.onResize.bind(this);\n    this.smoothTick = this.smoothUpdate.bind(this);\n    this.autoHeightTick = this.autoHeightUpdate.bind(this);\n  }\n\n  bindEvents() {\n    window.addEventListener('scroll', this.onScrollEvent);\n    window.addEventListener('resize', this.onResizeEvent);\n  }\n\n  unbindEvents() {\n    window.removeEventListener('scroll', this.onScrollEvent);\n    window.removeEventListener('resize', this.onResizeEvent);\n  }\n\n  onScroll() {\n    if (this.lockedScroll !== null) this.scrollTo(this.lockedScroll);\n\n    this.targetScroll = window.scrollY;\n\n    cancelAnimationFrame(this.smoothRaf);\n    this.smoothRaf = requestAnimationFrame(this.smoothTick);\n  }\n\n  smoothUpdate() {\n    if (this.lockedScroll !== null) return;\n\n    if (Math.abs(this.targetScroll - this.lastScroll) < this.smoothLimit) {\n      this.updateScroll(this.targetScroll);\n      this.onComplete(this.targetScroll);\n      return;\n    }\n\n    this.updateScroll(lerp(this.lastScroll, this.targetScroll, this.smoothFactor));\n\n    this.smoothRaf = requestAnimationFrame(this.smoothTick);\n  }\n\n  updateScroll(scroll) {\n    this.lastScroll = scroll;\n    this.scrollEl.scrollTop = scroll;\n    this.onUpdate(scroll);\n  }\n\n  onResize() {\n    this.updateHeight();\n    this.updateHeight(); // double to fix some size issues\n  }\n\n  updateHeight() {\n    const scrollHeight = this.scrollEl.scrollHeight;\n    if (scrollHeight === this.lastHeight) return;\n\n    this.lastHeight = scrollHeight;\n    style(this.bodyEl, {\n      height: `${scrollHeight}px`,\n    });\n  }\n\n  startAutoHeight() {\n    if (this.autoHeight === 0 || this.autoHeight === false) return;\n\n    this.heightRaf = requestAnimationFrame(this.autoHeightTick);\n  }\n\n  stopAutoHeight() {\n    cancelAnimationFrame(this.heightRaf);\n  }\n\n  autoHeightUpdate() {\n    if (++this.autoHeightFrame >= this.autoHeight) {\n      this.autoHeightFrame = 0;\n      this.updateHeight();\n    }\n\n    this.heightRaf = requestAnimationFrame(this.autoHeightTick);\n  }\n\n  /**\n   * scrollTo\n   * @public\n   * @param {Number} scroll scroll value\n   */\n  scrollTo(scroll) {\n    document.body.scrollTop = document.documentElement.scrollTop = scroll;\n  }\n\n  /**\n   * lock scroll\n   * @public\n   */\n  lock() {\n    this.lockedScroll = this.lastScroll;\n  }\n\n  /**\n   * unlock scroll\n   * @public\n   */\n  unlock() {\n    this.lockedScroll = null;\n  }\n\n  /**\n   * destroy AFScroll\n   * @public\n   */\n  destroy() {\n    if (this.scrollEl === null) return;\n\n    this.stopAutoHeight();\n    this.unbindEvents();\n    this.removeScroll();\n\n    this.lockedScroll = null;\n  }\n\n  /**\n   * remove scroll wrapper element\n   */\n  removeScroll() {\n    const { bodyEl, scrollEl, staticScrollEl } = this;\n\n    style(bodyEl, { height: '' });\n    this.scrollEl = null;\n    this.autoHeightFrame = 0;\n    this.lastHeight = null;\n\n    if (staticScrollEl !== null) {\n      style(scrollEl, {\n        position: '',\n        top: '',\n        left: '',\n        width: '',\n        height: '',\n        overflow: '',\n      });\n\n      return;\n    }\n\n    const childrenArr = [];\n    each(scrollEl.children, childEl => {\n      childrenArr.push(childEl);\n    });\n    each(childrenArr, childEl => {\n      bodyEl.insertBefore(childEl, scrollEl);\n    });\n    bodyEl.removeChild(scrollEl);\n  }\n}","/**\n * lerp\n * @param {Array} arr array or other iterable collection\n * @param {Function} cb callback function for each array element\n */\nexport function each(arr, cb) {\n  const l = arr.length;\n  for (let i = 0; i < l; i++) {\n    const result = cb(arr[i], i, arr);\n    if (result === true) continue;\n    if (result === false) break;\n  }\n}\n\n/**\n * lerp\n * @param {Number} begin begin value\n * @param {Number} end end value\n * @param {Number} factor in range 0.0 - 1.0\n * @returns interpolated value\n */\nexport function lerp(begin, end, factor) {\n  return begin + ((end - begin) * factor);\n}\n\n/**\n * style\n * @param {Element} el\n * @param {Object} styles\n */\nexport function style(el, styles) {\n  Object.keys(styles).forEach(styleKey => {\n    el.style[styleKey] = styles[styleKey];\n  });\n}\n\nexport default {\n  each,\n  lerp,\n  style,\n};"],"names":[],"version":3,"file":"module.js.map"}