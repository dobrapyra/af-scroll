{"mappings":";;;;;;;;;;ACKO,SAAS,yCAAI,CAAC,GAAG,EAAE,EAAE,EAAE;IAC5B,MAAM,CAAC,GAAG,GAAG,CAAC,MAAM,AAAC;IACrB,IAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAE;QAC1B,MAAM,MAAM,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,AAAC;QAClC,IAAI,MAAM,KAAK,IAAI,EAAE,SAAS;QAC9B,IAAI,MAAM,KAAK,KAAK,EAAE,MAAM;KAC7B;CACF;AASM,SAAS,yCAAI,CAAC,KAAK,EAAE,GAAG,EAAE,MAAM,EAAE;IACvC,OAAO,KAAK,GAAI,AAAC,CAAA,GAAG,GAAG,KAAK,CAAA,GAAI,MAAM,AAAC,CAAC;CACzC;AAOM,SAAS,yCAAK,CAAC,EAAE,EAAE,MAAM,EAAE;IAChC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,CAAA,QAAQ,GAAI;QACtC,EAAE,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,MAAM,CAAC,QAAQ,CAAC,CAAC;KACvC,CAAC,CAAC;CACJ;IAED,wCAIE,GAJa;UACb,yCAAI;UACJ,yCAAI;WACJ,yCAAK;CACN;;ADxCD;AAce;IACb,YAAY,eACV,WAAW,GAAG,GAAG,gBACjB,WAAW,GAAG,GAAG,aACjB,QAAQ,GAAG,IAAI,cACf,SAAS,GAAG,UAAU,gBACtB,WAAW,GAAG,cAAc,eAC5B,UAAU,GAAG,EAAE,aACf,QAAQ,GAAG,IAAM,EAAE,eACnB,UAAU,GAAG,IAAM,EAAE,GACtB,GAAG,EAAE,CAAE;QACN,IAAI,CAAC,YAAY,GAAG,CAAC,GAAG,WAAW,CAAC;QACpC,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;QAC/B,IAAI,CAAC,cAAc,GAAG,QAAQ,CAAC;QAC/B,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC3B,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;QAC/B,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;QAC7B,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;QAE7B,IAAI,CAAC,YAAY,GAAG,CAAC,CAAC;QACtB,IAAI,CAAC,UAAU,GAAG,CAAC,CAAC;QACpB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;QAEzB,IAAI,CAAC,MAAM,GAAG,QAAQ,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;QACvD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;QACrB,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC;QACzB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QAEvB,IAAI,CAAC,QAAQ,EAAE,CAAC;QAChB,IAAI,CAAC,IAAI,EAAE,CAAC;KACb;IAED;;;KAGG,CACH,IAAI,GAAG;QACL,IAAI,IAAI,CAAC,QAAQ,KAAK,IAAI,EAAE,OAAO;QAEnC,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC,OAAO,CAAC;QACnC,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,IAAI,CAAC,QAAQ,EAAE,CAAC;QAEhB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QACjC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAErC,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,CAAC,eAAe,EAAE,CAAC;KACxB;IAED;;KAEG,CACH,YAAY,GAAG;QACb,MAAM,UAAE,MAAM,CAAA,kBAAE,cAAc,CAAA,EAAE,GAAG,IAAI,AAAC;QAExC,MAAM,QAAQ,GAAG,cAAc,KAAK,IAAI,GACpC,cAAc,GACd,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,AAAC;QAClC,CAAA,GAAA,yCAAK,CAAA,CAAC,QAAQ,EAAE;YACd,QAAQ,EAAE,OAAO;YACjB,GAAG,EAAE,CAAC;YACN,IAAI,EAAE,CAAC;YACP,KAAK,EAAE,MAAM;YACb,MAAM,EAAE,MAAM;YACd,QAAQ,EAAE,QAAQ;SACnB,CAAC,CAAC;QAEH,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAEzB,IAAI,cAAc,KAAK,IAAI,EAAE,OAAO;QAEpC,MAAM,aAAE,SAAS,CAAA,eAAE,WAAW,CAAA,EAAE,GAAG,IAAI,AAAC;QAExC,QAAQ,CAAC,YAAY,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC;QAE1C,MAAM,WAAW,GAAG,EAAE,AAAC;QACvB,CAAA,GAAA,yCAAI,CAAA,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAA,OAAO,GAAI;YAC/B,IAAI,OAAO,KAAK,QAAQ,IAAI,OAAO,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE,OAAO,IAAI,CAAC;YACtE,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SAC3B,CAAC,CAAC;QACH,CAAA,GAAA,yCAAI,CAAA,CAAC,WAAW,EAAE,CAAA,OAAO,GAAI;YAC3B,QAAQ,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;SAC/B,CAAC,CAAC;QACH,MAAM,CAAC,YAAY,CAAC,QAAQ,EAAE,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;KACnD;IAED,QAAQ,GAAG;QACT,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC9C,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC9C,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC/C,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KACxD;IAED,UAAU,GAAG;QACX,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;QACtD,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;KACvD;IAED,YAAY,GAAG;QACb,MAAM,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;QACzD,MAAM,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;KAC1D;IAED,QAAQ,GAAG;QACT,IAAI,IAAI,CAAC,YAAY,KAAK,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAEjE,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC,OAAO,CAAC;QAEnC,oBAAoB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACrC,IAAI,CAAC,SAAS,GAAG,qBAAqB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;KACzD;IAED,YAAY,GAAG;QACb,IAAI,IAAI,CAAC,YAAY,KAAK,IAAI,EAAE,OAAO;QAEvC,IAAI,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC,WAAW,EAAE;YACpE,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YACrC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YACnC,OAAO;SACR;QAED,IAAI,CAAC,YAAY,CAAC,CAAA,GAAA,yCAAI,CAAA,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC;QAE/E,IAAI,CAAC,SAAS,GAAG,qBAAqB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;KACzD;IAED,YAAY,CAAC,MAAM,EAAE;QACnB,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;QACzB,IAAI,CAAC,QAAQ,CAAC,SAAS,GAAG,MAAM,CAAC;QACjC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;KACvB;IAED,QAAQ,GAAG;QACT,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,IAAI,CAAC,YAAY,EAAE,CAAC,CAAC,iCAAiC;KACvD;IAED,YAAY,GAAG;QACb,MAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,YAAY,AAAC;QAChD,IAAI,YAAY,KAAK,IAAI,CAAC,UAAU,EAAE,OAAO;QAE7C,IAAI,CAAC,UAAU,GAAG,YAAY,CAAC;QAC/B,CAAA,GAAA,yCAAK,CAAA,CAAC,IAAI,CAAC,MAAM,EAAE;YACjB,MAAM,EAAE,CAAC,EAAE,YAAY,CAAC,EAAE,CAAC;SAC5B,CAAC,CAAC;KACJ;IAED,eAAe,GAAG;QAChB,IAAI,IAAI,CAAC,UAAU,KAAK,CAAC,IAAI,IAAI,CAAC,UAAU,KAAK,KAAK,EAAE,OAAO;QAE/D,IAAI,CAAC,SAAS,GAAG,qBAAqB,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;KAC7D;IAED,cAAc,GAAG;QACf,oBAAoB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;KACtC;IAED,gBAAgB,GAAG;QACjB,IAAI,EAAE,IAAI,CAAC,eAAe,IAAI,IAAI,CAAC,UAAU,EAAE;YAC7C,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC;YACzB,IAAI,CAAC,YAAY,EAAE,CAAC;SACrB;QAED,IAAI,CAAC,SAAS,GAAG,qBAAqB,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;KAC7D;IAED;;;;KAIG,CACH,QAAQ,CAAC,MAAM,EAAE;QACf,QAAQ,CAAC,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,eAAe,CAAC,SAAS,GAAG,MAAM,CAAC;KACvE;IAED;;;KAGG,CACH,IAAI,GAAG;QACL,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC;KACrC;IAED;;;KAGG,CACH,MAAM,GAAG;QACP,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;KAC1B;IAED;;;KAGG,CACH,OAAO,GAAG;QACR,IAAI,IAAI,CAAC,QAAQ,KAAK,IAAI,EAAE,OAAO;QAEnC,IAAI,CAAC,cAAc,EAAE,CAAC;QACtB,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,IAAI,CAAC,YAAY,EAAE,CAAC;QAEpB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;KAC1B;IAED;;KAEG,CACH,YAAY,GAAG;QACb,MAAM,UAAE,MAAM,CAAA,YAAE,QAAQ,CAAA,kBAAE,cAAc,CAAA,EAAE,GAAG,IAAI,AAAC;QAElD,CAAA,GAAA,yCAAK,CAAA,CAAC,MAAM,EAAE;YAAE,MAAM,EAAE,EAAE;SAAE,CAAC,CAAC;QAC9B,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;QACrB,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC;QACzB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QAEvB,IAAI,cAAc,KAAK,IAAI,EAAE;YAC3B,CAAA,GAAA,yCAAK,CAAA,CAAC,QAAQ,EAAE;gBACd,QAAQ,EAAE,EAAE;gBACZ,GAAG,EAAE,EAAE;gBACP,IAAI,EAAE,EAAE;gBACR,KAAK,EAAE,EAAE;gBACT,MAAM,EAAE,EAAE;gBACV,QAAQ,EAAE,EAAE;aACb,CAAC,CAAC;YAEH,OAAO;SACR;QAED,MAAM,WAAW,GAAG,EAAE,AAAC;QACvB,CAAA,GAAA,yCAAI,CAAA,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAA,OAAO,GAAI;YACjC,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SAC3B,CAAC,CAAC;QACH,CAAA,GAAA,yCAAI,CAAA,CAAC,WAAW,EAAE,CAAA,OAAO,GAAI;YAC3B,MAAM,CAAC,YAAY,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;SACxC,CAAC,CAAC;QACH,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;KAC9B;CACF","sources":["src/index.js","src/helpers.js"],"sourcesContent":["import { each, lerp, style } from './helpers';\n\n/**\n * AFScroll (Animation Frame Scroll)\n * @param {Object} options general options\n * @property {Number} smoothForce smoothing force in range 0.0 - 1.0, 0: no smooth, 1: no scroll\n * @property {Number} smoothLimit min diff between current and target value to keep smooth loop\n * @property {Element} scrollEl static scroll wrapper element\n * @property {String} className css class name of scroll wrapper element\n * @property {Array} wrapExclude css selector to exclude from wrapping\n * @property {Number} autoHeight height checkoing period in frames, 1: each frame, 0: disabled\n * @property {Function} onUpdate callback function triggered on scroll update\n * @property {Function} onComplete callback function triggered after smooth loop stopped\n */\nexport default class AFScroll {\n  constructor({\n    smoothForce = 0.8,\n    smoothLimit = 0.2,\n    scrollEl = null,\n    className = 'afScroll',\n    wrapExclude = 'script, link',\n    autoHeight = 12,\n    onUpdate = () => {},\n    onComplete = () => {}\n  } = {}) {\n    this.smoothFactor = 1 - smoothForce;\n    this.smoothLimit = smoothLimit;\n    this.staticScrollEl = scrollEl;\n    this.className = className;\n    this.wrapExclude = wrapExclude;\n    this.autoHeight = autoHeight;\n    this.onUpdate = onUpdate;\n    this.onComplete = onComplete;\n\n    this.targetScroll = 0;\n    this.lastScroll = 0;\n    this.lockedScroll = null;\n\n    this.bodyEl = document.getElementsByTagName('body')[0];\n    this.scrollEl = null;\n    this.autoHeightFrame = 0;\n    this.lastHeight = null;\n\n    this.bindThis();\n    this.init();\n  }\n\n  /**\n   * initialize AFScroll\n   * @public\n   */\n  init() {\n    if (this.scrollEl !== null) return;\n\n    this.targetScroll = window.scrollY;\n    this.createScroll();\n    this.onResize();\n\n    this.scrollTo(this.targetScroll);\n    this.updateScroll(this.targetScroll);\n\n    this.bindEvents();\n    this.startAutoHeight();\n  }\n\n  /**\n   * create scroll wrapper element\n   */\n  createScroll() {\n    const { bodyEl, staticScrollEl } = this;\n\n    const scrollEl = staticScrollEl !== null\n      ? staticScrollEl\n      : document.createElement('div');\n    style(scrollEl, {\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      width: '100%',\n      height: '100%',\n      overflow: 'hidden',\n    });\n\n    this.scrollEl = scrollEl;\n\n    if (staticScrollEl !== null) return;\n\n    const { className, wrapExclude } = this;\n\n    scrollEl.setAttribute('class', className);\n\n    const childrenArr = [];\n    each(bodyEl.children, childEl => {\n      if (childEl === scrollEl || childEl.matches(wrapExclude)) return true;\n      childrenArr.push(childEl);\n    });\n    each(childrenArr, childEl => {\n      scrollEl.appendChild(childEl);\n    });\n    bodyEl.insertBefore(scrollEl, bodyEl.children[0]);\n  }\n\n  bindThis() {\n    this.onScrollEvent = this.onScroll.bind(this);\n    this.onResizeEvent = this.onResize.bind(this);\n    this.smoothTick = this.smoothUpdate.bind(this);\n    this.autoHeightTick = this.autoHeightUpdate.bind(this);\n  }\n\n  bindEvents() {\n    window.addEventListener('scroll', this.onScrollEvent);\n    window.addEventListener('resize', this.onResizeEvent);\n  }\n\n  unbindEvents() {\n    window.removeEventListener('scroll', this.onScrollEvent);\n    window.removeEventListener('resize', this.onResizeEvent);\n  }\n\n  onScroll() {\n    if (this.lockedScroll !== null) this.scrollTo(this.lockedScroll);\n\n    this.targetScroll = window.scrollY;\n\n    cancelAnimationFrame(this.smoothRaf);\n    this.smoothRaf = requestAnimationFrame(this.smoothTick);\n  }\n\n  smoothUpdate() {\n    if (this.lockedScroll !== null) return;\n\n    if (Math.abs(this.targetScroll - this.lastScroll) < this.smoothLimit) {\n      this.updateScroll(this.targetScroll);\n      this.onComplete(this.targetScroll);\n      return;\n    }\n\n    this.updateScroll(lerp(this.lastScroll, this.targetScroll, this.smoothFactor));\n\n    this.smoothRaf = requestAnimationFrame(this.smoothTick);\n  }\n\n  updateScroll(scroll) {\n    this.lastScroll = scroll;\n    this.scrollEl.scrollTop = scroll;\n    this.onUpdate(scroll);\n  }\n\n  onResize() {\n    this.updateHeight();\n    this.updateHeight(); // double to fix some size issues\n  }\n\n  updateHeight() {\n    const scrollHeight = this.scrollEl.scrollHeight;\n    if (scrollHeight === this.lastHeight) return;\n\n    this.lastHeight = scrollHeight;\n    style(this.bodyEl, {\n      height: `${scrollHeight}px`,\n    });\n  }\n\n  startAutoHeight() {\n    if (this.autoHeight === 0 || this.autoHeight === false) return;\n\n    this.heightRaf = requestAnimationFrame(this.autoHeightTick);\n  }\n\n  stopAutoHeight() {\n    cancelAnimationFrame(this.heightRaf);\n  }\n\n  autoHeightUpdate() {\n    if (++this.autoHeightFrame >= this.autoHeight) {\n      this.autoHeightFrame = 0;\n      this.updateHeight();\n    }\n\n    this.heightRaf = requestAnimationFrame(this.autoHeightTick);\n  }\n\n  /**\n   * scrollTo\n   * @public\n   * @param {Number} scroll scroll value\n   */\n  scrollTo(scroll) {\n    document.body.scrollTop = document.documentElement.scrollTop = scroll;\n  }\n\n  /**\n   * lock scroll\n   * @public\n   */\n  lock() {\n    this.lockedScroll = this.lastScroll;\n  }\n\n  /**\n   * unlock scroll\n   * @public\n   */\n  unlock() {\n    this.lockedScroll = null;\n  }\n\n  /**\n   * destroy AFScroll\n   * @public\n   */\n  destroy() {\n    if (this.scrollEl === null) return;\n\n    this.stopAutoHeight();\n    this.unbindEvents();\n    this.removeScroll();\n\n    this.lockedScroll = null;\n  }\n\n  /**\n   * remove scroll wrapper element\n   */\n  removeScroll() {\n    const { bodyEl, scrollEl, staticScrollEl } = this;\n\n    style(bodyEl, { height: '' });\n    this.scrollEl = null;\n    this.autoHeightFrame = 0;\n    this.lastHeight = null;\n\n    if (staticScrollEl !== null) {\n      style(scrollEl, {\n        position: '',\n        top: '',\n        left: '',\n        width: '',\n        height: '',\n        overflow: '',\n      });\n\n      return;\n    }\n\n    const childrenArr = [];\n    each(scrollEl.children, childEl => {\n      childrenArr.push(childEl);\n    });\n    each(childrenArr, childEl => {\n      bodyEl.insertBefore(childEl, scrollEl);\n    });\n    bodyEl.removeChild(scrollEl);\n  }\n}","/**\n * lerp\n * @param {Array} arr array or other iterable collection\n * @param {Function} cb callback function for each array element\n */\nexport function each(arr, cb) {\n  const l = arr.length;\n  for (let i = 0; i < l; i++) {\n    const result = cb(arr[i], i, arr);\n    if (result === true) continue;\n    if (result === false) break;\n  }\n}\n\n/**\n * lerp\n * @param {Number} begin begin value\n * @param {Number} end end value\n * @param {Number} factor in range 0.0 - 1.0\n * @returns interpolated value\n */\nexport function lerp(begin, end, factor) {\n  return begin + ((end - begin) * factor);\n}\n\n/**\n * style\n * @param {Element} el\n * @param {Object} styles\n */\nexport function style(el, styles) {\n  Object.keys(styles).forEach(styleKey => {\n    el.style[styleKey] = styles[styleKey];\n  });\n}\n\nexport default {\n  each,\n  lerp,\n  style,\n};"],"names":[],"version":3,"file":"main.js.map"}